<%-include('../partials/user-header')%>
<style>
	.image-holder{
  width: 500px;
  position: relative;
  cursor: pointer;
  >img{
    width: 100%;
    height: auto;
    object-fit: cover;
  }
}
.image-preview{
  width: 500px;
  height: 500px;
  overflow: hidden;
  position: relative;
  >img{
    position: absolute;
    top: 0;
    left: 0;
    transform: scale(2);
    transform-origin: left top;
  }
}
.d-none{
  display: none !important;
}
.magnifiying-glass{
  width: 100px;
  height: 100px;
  border: 1px dashed black;
  position: absolute;
  top: 0;
  left: 0;
  background: rgba(0,0,0,0.2);
}
figure{
  display: inline-block;
  vertical-align: top;
}
</style>

<%-include('../partials/user-nav')%>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/elevatezoom/3.0.1/jquery.elevatezoom.min.js"></script>


<section class="single-product">
	<div class="container">
		<div class="row">
			<div class="col-md-6">
				<ol class="breadcrumb">
					<li><a href="index.html">Home</a></li>
					<li><a href="shop.html">Shop</a></li>
					<li class="active">Single Product</li>
				</ol>
			</div>
			<!-- <div class="col-md-6">
				<ol class="product-pagination text-right">
					<li><a href="blog-left-sidebar.html"><i class="tf-ion-ios-arrow-left"></i> Next </a></li>
					<li><a href="blog-left-sidebar.html">Preview <i class="tf-ion-ios-arrow-right"></i></a></li>
				</ol>
			</div> -->
		</div>
		<div class="row mt-20">
			<div class="col-md-5">
				<div class="single-product-slider">
					<div id='carousel-custom' class='carousel slide' data-ride='carousel'>
						<div class='carousel-outer'>
							<!-- me art lab slider -->
							<div class='carousel-inner ' >
								<div class='item active' >
									<figure class="image-holder">
										<img id="image" src="/<%= product.photo[0] %>" alt="" data-zoom-image="" />
									  </div>
								  </figure>
								
							
							
							</div>
							
							<!-- sag sol -->
							<a class='left carousel-control' href='#carousel-custom' data-slide='prev'>
								<i class="tf-ion-ios-arrow-left"></i>
							</a>
							<a class='right carousel-control' href='#carousel-custom' data-slide='next'>
								<i class="tf-ion-ios-arrow-right"></i>
							</a>
						</div>
						
						<!-- thumb -->
						<ol class='carousel-indicators mCustomScrollbar meartlab'>
							<li data-target='#carousel-custom' data-slide-to='0' class='active'>
								<img src='/<%= product.photo[0]%>'alt='' />
							</li>
							<li data-target='#carousel-custom' data-slide-to='1'>
								<img src='/<%= product.photo[1]%>' alt='' />
							</li>
							<li data-target='#carousel-custom' data-slide-to='2'>
								<img src='/<%= product.photo[2]%>'alt='' />
							</li>
						
							
						</ol>
					</div>
				</div>
			</div>
			<div>
				<figure class="image-preview d-none">
					<img id="image-preview" src="/<%= product.photo[0] %>" alt="" data-zoom-image="/<%= product.photo[0] %>" />
					
				</figure>
			  
			  </div>
			<div class="col-md-7">
				<div class="single-product-details">
					<h2 class="product-name" title="<%= product.name %>"><%= product.name %></h2>
					<p class="product-price">$ <%= product.price %></p>
					
					<p class="product-description mt-20">
						Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laborum ipsum dicta quod, quia doloremque aut deserunt commodi quis. Totam a consequatur beatae nostrum, earum consequuntur? Eveniet consequatur ipsum dicta recusandae.
					</p>
					<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nesciunt, velit, sunt temporibus, nulla accusamus similique sapiente tempora, at atque cumque assumenda minus asperiores est esse sequi dolore magnam. Debitis, explicabo.</p>
				
					<div class="product-size">
						<span>Size:</span>
						<select class="form-control">
							<option>S</option>
							<option>M</option>
							<option>L</option>
							<option>XL</option>
						</select>
					</div>
					
					<div class="product-category">
						<span>Categories:</span>

						<ul>
							<li><a href=""><%= product.category_name %></a></li>
							
						</ul>
					<style>
						.product-name{
							white-space: nowrap;
                              overflow: hidden;
                          text-overflow: ellipsis;

						}
					</style>
						
					</div>
					<div>
						<span style="font-weight: bold ; color: red;">Available stocks:<%= product.stock %></span>
					</div>
					<% if (user) { %>
						<a href="#" class="add-to-cart-btn  btn btn-main mt-20" data-product-id="<%= product._id %>">Add To Cart</a>
					<% }else{ %>
						<a href="/login" class="btn btn-main mt-20">Add To Cart</a>
						<% } %>
					
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-xs-12">
				<div class="tabCommon mt-20">
					<ul class="nav nav-tabs">
						<li class="active"><a data-toggle="tab" href="#details" aria-expanded="true">Details</a></li>
						<li class=""><a data-toggle="tab" href="#reviews" aria-expanded="false">Reviews (3)</a></li>
					</ul>
					<div class="tab-content patternbg">
						<div id="details" class="tab-pane fade active in">
							<h4>Product Description</h4>
			              <p><%= product.description %></p>
						</div>
						<div id="reviews" class="tab-pane fade">
							<div class="post-comments">
						    	<ul class="media-list comments-list m-bot-50 clearlist">
								    <!-- Comment Item start-->
								    <li class="media">

								        <a class="pull-left" href="#!">
								            <img class="media-object comment-avatar" src="images/blog/avater-1.jpg" alt="" width="50" height="50" />
								        </a>

								        <div class="media-body">
								            <div class="comment-info">
								                <h4 class="comment-author">
								                    <a href="#!">Jonathon Andrew</a>
								                	
								                </h4>
								                <time datetime="2013-04-06T13:53">July 02, 2015, at 11:34</time>
								                <a class="comment-button" href="#!"><i class="tf-ion-chatbubbles"></i>Reply</a>
								            </div>

								            <p>
								                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque at magna ut ante eleifend eleifend.Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quod laborum minima, reprehenderit laboriosam officiis praesentium? Impedit minus provident assumenda quae.
								            </p>
								        </div>

								    </li>
								    <!-- End Comment Item -->

								    <!-- Comment Item start-->
								    <li class="media">

								        <a class="pull-left" href="#!">
								            <img class="media-object comment-avatar" src="images/blog/avater-4.jpg" alt="" width="50" height="50" />
								        </a>

								        <div class="media-body">

								            <div class="comment-info">
								                <div class="comment-author">
								                    <a href="#!">Jonathon Andrew</a>
								                </div>
								                <time datetime="2013-04-06T13:53">July 02, 2015, at 11:34</time>
								                <a class="comment-button" href="#!"><i class="tf-ion-chatbubbles"></i>Reply</a>
								            </div>

								            <p>
								                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque at magna ut ante eleifend eleifend. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Magni natus, nostrum iste non delectus atque ab a accusantium optio, dolor!
								            </p>

								        </div>

								    </li>
								    <!-- End Comment Item -->

								    <!-- Comment Item start-->
								    <li class="media">

								        <a class="pull-left" href="#!">
								            <img class="media-object comment-avatar" src="images/blog/avater-1.jpg" alt="" width="50" height="50">
								        </a>

								        <div class="media-body">

								            <div class="comment-info">
								                <div class="comment-author">
								                    <a href="#!">Jonathon Andrew</a>
								                </div>
								                <time datetime="2013-04-06T13:53">July 02, 2015, at 11:34</time>
								                <a class="comment-button" href="#!"><i class="tf-ion-chatbubbles"></i>Reply</a>
								            </div>

								            <p>
								                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque at magna ut ante eleifend eleifend.
								            </p>

								        </div>

								    </li>
							</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<footer class="footer section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<ul class="social-media">
					<li>
						<a href="https://www.facebook.com/themefisher">
							<i class="tf-ion-social-facebook"></i>
						</a>
					</li>
					<li>
						<a href="https://www.instagram.com/themefisher">
							<i class="tf-ion-social-instagram"></i>
						</a>
					</li>
					<li>
						<a href="https://www.twitter.com/themefisher">
							<i class="tf-ion-social-twitter"></i>
						</a>
					</li>
					<li>
						<a href="https://www.pinterest.com/themefisher/">
							<i class="tf-ion-social-pinterest"></i>
						</a>
					</li>
				</ul>
				<ul class="footer-menu text-uppercase">
					<li>
						<a href="contact.html">CONTACT</a>
					</li>
					<li>
						<a href="shop.html">SHOP</a>
					</li>
					<li>
						<a href="pricing.html">Pricing</a>
					</li>
					<li>
						<a href="contact.html">PRIVACY POLICY</a>
					</li>
				</ul>
				<!-- <p class="copyright-text">Copyright &copy;2021, Designed &amp; Developed by <a href="https://themefisher.com/">Themefisher</a></p> -->
			</div>
		</div>
	</div>
</footer>

<!-- <script>
	let main_prodcut_image = document.getElementById('main_product_image');
    $("#main_product_image").data('zoom-image', main_prodcut_image.src).elevateZoom({
        responsive: true,
		zoomLevel: 3,
        zoomWindowWidth: 500,
        zoomWindowHeight: 500,
        borderSize: 2,
        borderColour: '#888',
        lensShape: 'square',
        lensSize: 1,
        zoomWindowFadeIn: 500,
        zoomWindowFadeOut: 500
    });
</script> -->
<script>
	
	$(document).ready(function() {
  
  $('.add-to-cart-btn').click(function(e) {
    e.preventDefault(); 

    var productId = $(this).data('product-id');

    $.ajax({
      url: '/add-to-cart/' + productId,
      method: 'GET',
      dataType: 'json',
      success: function(response) {
      
        toastr.success(response.message);
      },
      error: function(xhr, status, error) {
       
        toastr.error('Error occurred while adding to cart.');
      }
    });
  });
});

</script>
<script>
	var holder = document.querySelector('.image-holder');
var image = document.getElementById('image');
var previewHolder = document.querySelector('.image-preview');
var imagePreview = document.getElementById('image-preview');
imagePreview.src = image.src;
holder.addEventListener('mousemove', () => {
    var magGlass = document.querySelector('.magnifiying-glass');
    let left = event.clientX - holder.offsetLeft;
    let top = event.clientY - holder.offsetTop;
    let height = image.clientHeight;
    let width = image.clientWidth;
    let previewWidth = imagePreview.clientWidth;
    let scaleValue = 2500 / previewWidth;
    imagePreview.style.transform = 'scale(' + scaleValue + ')';
    let magTop = top - 150;
    let magLeft = left - 150;
    if(magTop <= 0){
      magTop = 0;
    } 
    if(magLeft <= 0){
       magLeft = 0;
    }
    if(magLeft >= (width - 100)){
      magLeft = width - 100;
    }
    if(magTop >= (height - 100)){
       magTop = height - 100;
    }
    magGlass.style.top = magTop + 'px';
    magGlass.style.left = magLeft + 'px';
    let topPercentage = top / height * 100;
    let leftPercentage = left / width * 100;
    imagePreview.style.top = - (5 * magTop) + "px";
    imagePreview.style.left = - (5 * magLeft) + "px";
});
holder.addEventListener('mouseenter', () => {
    previewHolder.classList.remove('d-none');
    let magGlass = document.createElement("DIV");
    magGlass.className = 'magnifiying-glass';
    holder.appendChild(magGlass);
});
holder.addEventListener('mouseleave', () => {
    var magGlass = holder.querySelector('.magnifiying-glass');
    previewHolder.classList.add('d-none');
    magGlass.parentNode.removeChild(magGlass);
    imagePreview.style.top = 0;
    imagePreview.style.left = 0;
});



</script>

	

<%-include('../partials/user-footer')%>
